{"ast":null,"code":"var _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\bonaf\\\\Desktop\\\\Projects\\\\Ecommerce\\\\Malinka\\\\frontend\\\\malinka\\\\components\\\\stripe-button\\\\stripe-button.component.jsx\";\n\nvar __jsx = React.createElement;\nimport React from 'react';\nimport StripeCheckout from 'react-stripe-checkout';\nimport axios from 'axios';\nimport API_URL from '../../routes';\nimport { connect } from 'react-redux';\nimport { clearCart as _clearCart } from '../../src/redux/cart/cart.actions';\n\nvar StripeCheckoutButton = function StripeCheckoutButton(_ref) {\n  var price = _ref.price,\n      currentUser = _ref.currentUser,\n      cartItems = _ref.cartItems;\n  var order = \"\".concat(cartItems.map(function (cartItem) {\n    return \"\".concat(cartItem.name, \": \").concat(cartItem.quantity, \"\\n\");\n  }));\n\n  var onToken = function onToken(token) {\n    fetch(\"\".concat(API_URL, \"/orders\"), {\n      method: 'post',\n      headers: {\n        'Content-type': 'application/json'\n      },\n      body: JSON.stringify({\n        amount: priceForStripe,\n        Status: \"Pending\",\n        name: currentUser.email,\n        createdAt: new Date(),\n        OrderDetails: order,\n        token: token\n      })\n    }).then(function (response) {\n      console.log(response);\n\n      if (response.ok) {\n        alert('Payment successful');\n\n        _clearCart();\n      } else {\n        alert('There was an issue with your payment.');\n      }\n    })[\"catch\"](function (error) {\n      console.log('Payment error: ', error);\n      alert('There was an issue with your payment.');\n    });\n  };\n\n  var priceForStripe = price * 100;\n  var publishablekey = 'pk_test_cjTqGCwCgH7H6f2eJRaVcr5R00XHFNsn39';\n  return __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      alignSelf: 'flex-end',\n      marginTop: '20px'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 9\n    }\n  }, __jsx(StripeCheckout, {\n    label: \"Pay Now\",\n    name: \"TestShop\",\n    billingAddress: true,\n    shippingAddress: true,\n    description: \"Your total is \".concat(price),\n    amount: priceForStripe,\n    panelLabel: \"Pay Now\",\n    token: onToken,\n    stripeKey: publishablekey,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 13\n    }\n  }));\n};\n\n_c = StripeCheckoutButton;\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    clearCart: function clearCart() {\n      return dispatch(_clearCart());\n    }\n  };\n};\n\nexport default connect(null, mapDispatchToProps)(StripeCheckoutButton);\n\nvar _c;\n\n$RefreshReg$(_c, \"StripeCheckoutButton\");","map":{"version":3,"sources":["C:/Users/bonaf/Desktop/Projects/Ecommerce/Malinka/frontend/malinka/components/stripe-button/stripe-button.component.jsx"],"names":["React","StripeCheckout","axios","API_URL","connect","clearCart","StripeCheckoutButton","price","currentUser","cartItems","order","map","cartItem","name","quantity","onToken","token","fetch","method","headers","body","JSON","stringify","amount","priceForStripe","Status","email","createdAt","Date","OrderDetails","then","response","console","log","ok","alert","error","publishablekey","display","alignSelf","marginTop","mapDispatchToProps","dispatch"],"mappings":";;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,cAAP,MAA2B,uBAA3B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,OAAP,MAAoB,cAApB;AACA,SAAQC,OAAR,QAAsB,aAAtB;AACA,SAAQC,SAAS,IAATA,UAAR,QAAwB,mCAAxB;;AAEA,IAAMC,oBAAoB,GAAG,SAAvBA,oBAAuB,OAAyC;AAAA,MAArCC,KAAqC,QAArCA,KAAqC;AAAA,MAA9BC,WAA8B,QAA9BA,WAA8B;AAAA,MAAjBC,SAAiB,QAAjBA,SAAiB;AAClE,MAAMC,KAAK,aAAMD,SAAS,CAACE,GAAV,CAAc,UAAAC,QAAQ;AAAA,qBAAKA,QAAQ,CAACC,IAAd,eAAuBD,QAAQ,CAACE,QAAhC;AAAA,GAAtB,CAAN,CAAX;;AACA,MAAMC,OAAO,GAAG,SAAVA,OAAU,CAAAC,KAAK,EAAI;AACrBC,IAAAA,KAAK,WAAId,OAAJ,cAAqB;AAClBe,MAAAA,MAAM,EAAE,MADU;AAElBC,MAAAA,OAAO,EAAE;AAAC,wBAAgB;AAAjB,OAFS;AAGlBC,MAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACjBC,QAAAA,MAAM,EAAEC,cADS;AAEjBC,QAAAA,MAAM,EAAE,SAFS;AAGjBZ,QAAAA,IAAI,EAAEL,WAAW,CAACkB,KAHD;AAIjBC,QAAAA,SAAS,EAAE,IAAIC,IAAJ,EAJM;AAKjBC,QAAAA,YAAY,EAAEnB,KALG;AAMjBM,QAAAA,KAAK,EAALA;AANiB,OAAf;AAHY,KAArB,CAAL,CAYGc,IAZH,CAYQ,UAAAC,QAAQ,EAAI;AAChBC,MAAAA,OAAO,CAACC,GAAR,CAAYF,QAAZ;;AACA,UAAGA,QAAQ,CAACG,EAAZ,EAAe;AACXC,QAAAA,KAAK,CAAC,oBAAD,CAAL;;AACA9B,QAAAA,UAAS;AACZ,OAHD,MAIS;AACD8B,QAAAA,KAAK,CAAC,uCAAD,CAAL;AACH;AAER,KAtBD,WAsBS,UAAAC,KAAK,EAAI;AACdJ,MAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BG,KAA/B;AACAD,MAAAA,KAAK,CAAC,uCAAD,CAAL;AACH,KAzBD;AA0BH,GA3BD;;AA6BA,MAAMX,cAAc,GAAGjB,KAAK,GAAG,GAA/B;AAEA,MAAM8B,cAAc,GAAG,4CAAvB;AACA,SACI;AAAK,IAAA,KAAK,EAAE;AAACC,MAAAA,OAAO,EAAE,MAAV;AAAiBC,MAAAA,SAAS,EAAC,UAA3B;AAAuCC,MAAAA,SAAS,EAAC;AAAjD,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,MAAC,cAAD;AACI,IAAA,KAAK,EAAG,SADZ;AAEI,IAAA,IAAI,EAAG,UAFX;AAGI,IAAA,cAAc,MAHlB;AAII,IAAA,eAAe,MAJnB;AAKI,IAAA,WAAW,0BAAqBjC,KAArB,CALf;AAMI,IAAA,MAAM,EAAIiB,cANd;AAOI,IAAA,UAAU,EAAC,SAPf;AAQI,IAAA,KAAK,EAAET,OARX;AASI,IAAA,SAAS,EAAEsB,cATf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,CADJ;AAeH,CAjDD;;KAAM/B,oB;;AAoDN,IAAMmC,kBAAkB,GAAG,SAArBA,kBAAqB,CAAAC,QAAQ;AAAA,SAAI;AACnCrC,IAAAA,SAAS,EAAE;AAAA,aAAMqC,QAAQ,CAACrC,UAAS,EAAV,CAAd;AAAA;AADwB,GAAJ;AAAA,CAAnC;;AAIA,eAAeD,OAAO,CAAC,IAAD,EAAOqC,kBAAP,CAAP,CAAkCnC,oBAAlC,CAAf","sourcesContent":["import React from 'react';\r\nimport StripeCheckout from 'react-stripe-checkout';\r\nimport axios from 'axios';\r\nimport API_URL from '../../routes';\r\nimport {connect} from 'react-redux';\r\nimport {clearCart} from '../../src/redux/cart/cart.actions'\r\n\r\nconst StripeCheckoutButton = ( { price, currentUser, cartItems } ) => {\r\n    const order = `${cartItems.map(cartItem=>`${cartItem.name}: ${cartItem.quantity}\\n`)}`\r\n    const onToken = token => {\r\n        fetch(`${API_URL}/orders`,{\r\n                method: 'post',\r\n                headers: {'Content-type': 'application/json'},\r\n                body: JSON.stringify({\r\n                    amount: priceForStripe,\r\n                    Status: \"Pending\",\r\n                    name: currentUser.email,\r\n                    createdAt: new Date(),\r\n                    OrderDetails: order,\r\n                    token\r\n                })\r\n                \r\n        }).then(response => {\r\n            console.log(response)\r\n            if(response.ok){\r\n                alert('Payment successful')\r\n                clearCart()\r\n            }\r\n                else {\r\n                    alert('There was an issue with your payment.')\r\n                }\r\n            \r\n        }).catch(error => {\r\n            console.log('Payment error: ', error)\r\n            alert('There was an issue with your payment.')\r\n        })\r\n    }\r\n\r\n    const priceForStripe = price * 100\r\n    \t\r\n    const publishablekey = 'pk_test_cjTqGCwCgH7H6f2eJRaVcr5R00XHFNsn39'\r\n    return (\r\n        <div style={{display: 'flex',alignSelf:'flex-end', marginTop:'20px'}}>\r\n            <StripeCheckout \r\n                label = 'Pay Now'\r\n                name = 'TestShop'\r\n                billingAddress\r\n                shippingAddress\r\n                description = {`Your total is ${price}`}\r\n                amount = {priceForStripe}\r\n                panelLabel='Pay Now'\r\n                token={onToken}\r\n                stripeKey={publishablekey}\r\n            />\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nconst mapDispatchToProps = dispatch=> ({\r\n    clearCart: () => dispatch(clearCart())\r\n})\r\n\r\nexport default connect(null, mapDispatchToProps)(StripeCheckoutButton)"]},"metadata":{},"sourceType":"module"}